<tool id="mixcr.align" name="Align (MiXCR)">
  <description>Align sequencing reads to reference V, D, and J genes of T-cell receptors</description>

  <command>
    java -Xmx10g -jar /home/exacloud/lustre1/GalaxyinstalledTest/galaxy-dist/tools/tcr_seq/galaxy_tools/align/mixcr.jar
<!--    java -Xmx10g -jar /home/exacloud/lustre1/users/letaw/galaxy_intel/galaxy/tools/tcrseq/galaxy_tools/align/mixcr.jar -->
    align -f -c $chain -s $species $save_des $save_reads $all_reads
    -OminSumScore=$min_sum -OvParameters.parameters.absoluteMinScore=$v_abs_min -OjParameters.parameters.absoluteMinScore=$j_abs_min
    -r $report $input $output
  </command>

  <inputs>
    <param name="input" type="data" format="fastq" label="Input FastQ" help="Fastq file assembled by PEAR, with spiked reads
									     removed.">
    </param>
    
    <param name="chain" type="select" label="Chain" multiple="TRUE" help="Target immunological chain to  align to. Must select one -
									  we align to TRB">
      <option value="TRB">TRB</option>
      <option value="TRA">TRA</option>
      <option value="TRG">TRG</option>
      <option value="TRD">TRG</option>
      <option value="IGH">IGH</option>
      <option value="IGL">IGL</option>
      <option value="IGK">IGK</option>
      <option value="ALL">ALL</option>
    </param>
    
    <param name="species" type="select" label="Species" help="Species to align to.">
      <option value="mmu">Mouse</option>
      <option value="hsa">Human</option>
    </param>
    
    <param name="save_des" type="select" label="Save description" help="Copy read description line from .fastq file,
											allowing for export in exportAlignments.
											Must select yes or no.">
      <option value="-a">Yes</option>
      <option value=''>No</option>
    </param>
    
    <param name="save_reads" type="select" label="Save reads" help="Copy read from .fastq file (required for
										    exporting reads aggregated by clones).
										    Must select yes or no.">
      <option value="-g">Yes</option>
      <option value="">No</option>
    </param>

    <param name="all_reads" type="select" label="Output all reads" help="Write alignment results for all input reads - including empty
									 results for non-aligned reads.">
      <option value="-v">Yes</option>
      <option value="">No</option>
    </param>

    <param name="min_sum" type="float" size="4" value="120.0" label="Minimal Total Alignment Score" help="Minimal total value of
													  alignment scores for V and J
													  genes. Default is 120.0">
    </param>

    <param name="v_abs_min" type="float" size="4" value="40" label="Absolute minimal V alignment score" help="Minimal score of
													      alignment. Any
													      alignments with samller
													      score will be dropped.">
    </param>
    <param name="j_abs_min" type="float" size="4" value="40" label="Absolute minimal J alignment score" help="Minimal score of
													      alignment. Any
													      alignments with samller
													      score will be dropped.">
    </param>

  </inputs>

  <outputs>
    <data name="report" format="tabular" label="Align Report"/>
    <data name="output" label="Alignment"/>
  </outputs>

  <help>
    The MiXCR Align program takes despiked sequencing reads and aligns them to reference V, D, and J genes of T-Cell Receptors. The GenBank database is used for reference sequences. This tool defaults to the mouse TRB (T-Cell Receptor Beta chain) locus, and currently does not support switching to other organisms or loci.
  </help>
  
  
</tool>
